syncPolicy:
  automated:
    selfHeal: true
    allowEmpty: true
    prune: true
  retry:
    limit: -1 # number of failed sync attempt retries; unlimited number of attempts if less than 0
    backoff:
      duration: 5s # the amount to back off. Default unit is seconds, but could also be a duration (e.g. "2m", "1h")
      factor: 2 # a factor to multiply the base duration after each failed retry
      maxDuration: 10m # the maximum amount of time allowed for the backoff strategy
  syncOptions:
    - CreateNamespace=true
    - ServerSideApply=true  # Big CRDs.
syncPolicyAppSet:
  preserveResourcesOnDeletion: false # to be able to cleanup
useSelectors: true
repoURLGit: '{{.metadata.annotations.addons_repo_url}}'
repoURLGitRevision: '{{.metadata.annotations.addons_repo_revision}}'
repoURLGitBasePath: '{{.metadata.annotations.addons_repo_basepath}}'
valueFiles:
  - default/addons
  - environments/{{.metadata.labels.environment}}/addons
  - clusters/{{.nameNormalized}}/addons
useValuesFilePrefix: true
valuesFilePrefix: 'tenants/{{.metadata.labels.tenant}}/'

########################################
# define Addons
########################################

external-secrets:
  enabled: false
  enableACK: false
  annotationsAppSet:
    argocd.argoproj.io/sync-wave: "3" # Needs to be after KRO RGD  
  namespace: external-secrets
  chartName: external-secrets
  defaultVersion: "0.10.3"
  chartRepository: "https://charts.external-secrets.io"
  selector:
    matchExpressions:
      - key: enable_external_secrets
        operator: In
        values: ['true']
  valuesObject:
    serviceAccount:
      name: "external-secrets-sa"

kro-eks-rgs:
  enabled: false
  type: manifest
  namespace: kro
  annotationsAppSet:
    argocd.argoproj.io/sync-wave: "-2" # Needs to be before resources that needs PodIdentity 
  path: 'charts/kro/resource-groups/eks'
  chartRepository: '{{.metadata.annotations.addons_repo_url}}'
  targetRevision: '{{.metadata.annotations.addons_repo_revision}}'
  selector:
    matchExpressions:
      - key: enable_kro_eks_rgs
        operator: In
        values: ['true']

multi-acct:
  enabled: false
  namespace: kro
  annotationsAppSet:
    argocd.argoproj.io/sync-wave: "-5" # Needs to be before KRO RGD  
  defaultVersion: "0.1.0"
  path: charts/multi-acct
  selector:
    matchExpressions:
      - key: enable_multi_acct
        operator: In
        values: ['true']